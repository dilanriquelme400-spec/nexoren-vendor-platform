<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nexoren Admin</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<style>
body{margin:0;font-family:system-ui;background:#0f0f14;color:#fff;}
.container{max-width:900px;margin:auto;padding:40px 20px;}
.card{background:#151521;border-radius:14px;padding:24px;margin-bottom:20px;}
input{width:100%;padding:12px;border-radius:10px;border:none;background:#1e1e2b;color:#fff;margin-top:10px;}
button{background:#5B2EFF;color:white;border:none;padding:12px 18px;border-radius:10px;font-weight:700;cursor:pointer;margin-top:10px;}
img{max-width:120px;border-radius:8px;margin-top:8px;margin-right:8px;}
</style>
</head>

<body>
<div class="container">

<div class="card">
  <h2>Admin Token</h2>
  <input id="token" placeholder="paste ADMIN_TOKEN">
  <button onclick="loadSellers()">Load applications</button>
</div>

<div id="list"></div>

</div>

<script>
const API = location.origin;

function authHeaders() {
  const token = (document.getElementById("token").value || "").trim();
  return {
    "Authorization": "Bearer " + token,
    "x-admin-token": token, // extra compat
  };
}

async function loadSellers(){
  const res = await fetch(API + "/admin/sellers",{
    headers: authHeaders()
  });

  const data = await res.json();

  if(!data.ok){
    alert(data.error || "No autorizado");
    return;
  }

  const list = document.getElementById("list");
  list.innerHTML="";

  data.rows.forEach(s=>{
    const div=document.createElement("div");
    div.className="card";

    div.innerHTML=`
      <h3>${s.fullName}</h3>
      <p><b>Email:</b> ${s.email}</p>
      <p><b>Store:</b> ${s.storeName}</p>
      <p><b>Status:</b> ${s.status}</p>

      <div>
        <img src="${s.idFrontUrl}" alt="id front">
        <img src="${s.idBackUrl}" alt="id back">
        <img src="${s.selfieUrl}" alt="selfie">
      </div>

      <button onclick="approve('${s._id}')">Approve</button>
      <button onclick="reject('${s._id}')">Reject</button>
    `;

    list.appendChild(div);
  });
}

async function approve(id){
  await fetch(API+"/admin/sellers/"+id+"/approve",{
    method:"POST",
    headers: authHeaders()
  });
  loadSellers();
}

async function reject(id){
  await fetch(API+"/admin/sellers/"+id+"/reject",{
    method:"POST",
    headers: authHeaders()
  });
  loadSellers();
}
</script>
</body>
</html>
